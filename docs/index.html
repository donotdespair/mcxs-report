<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yobin Timilsena">

<title>Macroeconometrics Research Report - Estimating the impact of monetary policy shocks on different housing indicators: An SVAR Approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question">Research Question</a></li>
  <li><a href="#data-and-their-properties" id="toc-data-and-their-properties" class="nav-link" data-scroll-target="#data-and-their-properties">Data and their Properties</a>
  <ul class="collapse">
  <li><a href="#empirical-project-setup" id="toc-empirical-project-setup" class="nav-link" data-scroll-target="#empirical-project-setup">Empirical Project Setup</a></li>
  <li><a href="#choice-of-variables" id="toc-choice-of-variables" class="nav-link" data-scroll-target="#choice-of-variables">Choice of variables</a></li>
  <li><a href="#data-properties" id="toc-data-properties" class="nav-link" data-scroll-target="#data-properties">Data Properties</a>
  <ul class="collapse">
  <li><a href="#adf-tests" id="toc-adf-tests" class="nav-link" data-scroll-target="#adf-tests">ADF Tests</a></li>
  <li><a href="#acf-plots" id="toc-acf-plots" class="nav-link" data-scroll-target="#acf-plots">ACF Plots</a></li>
  <li><a href="#pacf-plots" id="toc-pacf-plots" class="nav-link" data-scroll-target="#pacf-plots">PACF Plots</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#model-and-hypothesis" id="toc-model-and-hypothesis" class="nav-link" data-scroll-target="#model-and-hypothesis">Model and Hypothesis</a>
  <ul class="collapse">
  <li><a href="#basic-model" id="toc-basic-model" class="nav-link" data-scroll-target="#basic-model">Basic Model</a>
  <ul class="collapse">
  <li><a href="#identification" id="toc-identification" class="nav-link" data-scroll-target="#identification">Identification</a></li>
  <li><a href="#prior-distribution" id="toc-prior-distribution" class="nav-link" data-scroll-target="#prior-distribution">Prior distribution</a></li>
  <li><a href="#likelihood-function" id="toc-likelihood-function" class="nav-link" data-scroll-target="#likelihood-function">Likelihood Function</a></li>
  <li><a href="#posterior-distribution" id="toc-posterior-distribution" class="nav-link" data-scroll-target="#posterior-distribution">Posterior Distribution</a></li>
  <li><a href="#simulation-run" id="toc-simulation-run" class="nav-link" data-scroll-target="#simulation-run">Simulation Run</a></li>
  <li><a href="#data-results" id="toc-data-results" class="nav-link" data-scroll-target="#data-results">Data Results</a></li>
  </ul></li>
  <li><a href="#extended-model" id="toc-extended-model" class="nav-link" data-scroll-target="#extended-model">Extended Model</a></li>
  </ul></li>
  <li><a href="#empirical-investigation" id="toc-empirical-investigation" class="nav-link" data-scroll-target="#empirical-investigation">Empirical Investigation</a>
  <ul class="collapse">
  <li><a href="#impulse-response-functions-irfs" id="toc-impulse-response-functions-irfs" class="nav-link" data-scroll-target="#impulse-response-functions-irfs">Impulse Response Functions (IRFs)</a></li>
  <li><a href="#forecast-error-variance-decomposition" id="toc-forecast-error-variance-decomposition" class="nav-link" data-scroll-target="#forecast-error-variance-decomposition">Forecast Error Variance Decomposition</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Estimating the impact of monetary policy shocks on different housing indicators: An SVAR Approach</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yobin Timilsena </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><strong>Abstract.</strong> &lt;under construction!&gt;</p>
<p><strong>Keywords.</strong> bsvars, impulse responses, quarto, R, housing price index, monetary policy shocks</p>
</blockquote>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Monetary policy is one of the key instruments used by central banks to influence the overall economic activity. In recent years, the housing market has become an increasingly important channel through which monetary policy affects the broader economy (<span class="citation" data-cites="AK_2017">Aliber and Kindleberger (<a href="#ref-AK_2017" role="doc-biblioref">2017</a>)</span>), particularly in Australia where around 57% of household wealth is tied up in the housing market (<span class="citation" data-cites="Sweeney_2023">Sweeney (<a href="#ref-Sweeney_2023" role="doc-biblioref">2023</a>)</span>). That number is thrice as big as the size of the super market in Australia and as such, understanding the relationship between monetary policy shocks and the housing market is crucial for policymakers, investors, and households alike.</p>
<p>In this study, we aim to estimate the impact of monetary policy shocks on various housing indicators using a Structural Vector Autoregression (SVAR) modeling approach. SVAR models are a popular econometric tool for investigating the dynamic interactions between macroeconomic variables. By applying this approach, we seek to shed light on how changes in monetary policy impact different dimensions of the housing market.</p>
</section>
<section id="research-question" class="level1">
<h1>Research Question</h1>
<p>The objective of this paper is to estimate and quantify the impact of monetary policy shocks on different indicators of the housing market such as housing prices, housing transactions/sales, and the total number of housing units within an economy. Understanding these effects is crucial in understanding how money affects a key factor of the real side of the economy. An extension to this paper could be determining whether monetary policy shocks create a tradeoff between controlling housing prices and controlling economic activity.</p>
</section>
<section id="data-and-their-properties" class="level1">
<h1>Data and their Properties</h1>
<section id="empirical-project-setup" class="level2">
<h2 class="anchored" data-anchor-id="empirical-project-setup">Empirical Project Setup</h2>
<p>This project website is being developed as a <strong>Quarto</strong> document and the empirical work in conducted using <code>R</code>. The necessary datasets are imported from the Reserve Bank of Australia (RBA) and the Australian Bureau of Statistics (ABS) websites using <code>readrba</code> and <code>readabs</code> respectively.</p>
</section>
<section id="choice-of-variables" class="level2">
<h2 class="anchored" data-anchor-id="choice-of-variables">Choice of variables</h2>
<p>I use the following variables to answer this question. I discuss the relevance of each variable.</p>
<ul>
<li><p><span class="math inline">\(\log(M1)\)</span>: represents the log of the money supply M1. Both conventional and unconventional monetary policy shocks can change the stock of money supply and its size affects real variables of the economy.</p></li>
<li><p><span class="math inline">\(\Delta CPI\)</span>: represents the year-on-year change in the Consumer Price Index (CPI). It is a measure of inflation in an economy and is affected by monetary policy shocks.</p></li>
<li><p><span class="math inline">\(\log(c)\)</span>: represents the log of consumption of the economy. Monetary policy shocks can alter people’s consumption-savings behavior.</p></li>
<li><p><span class="math inline">\(\log(GDP)\)</span>: represents the log of the Gross Domestic Product (GDP). Including this along with the consumption helps differentiate the effect on the non-consumption aspect of the economy.</p></li>
<li><p><span class="math inline">\(loanrate\)</span>: represents the weighted average interest rates on owner-occupied home loans.</p></li>
<li><p><span class="math inline">\(AUCR\)</span>: represents the Australian Cash Rate Target. This is the major monetary policy instrument available to the RBA.</p></li>
<li><p><span class="math inline">\(USFFR\)</span>: represents the Federal Funds Rate Maximum Target Rate. Monetary policy adopted in the US tend to ripple into other economies so this is a variable of interest. Another extension to this variable would be to include the Target rates of Australia’s largest trading partners.</p></li>
<li><p><span class="math inline">\(nhouses\)</span>: represents the number of new private dwellings (houses) approved for construction in Australia. Impact on housing prices might be dampened by the supply elasticity of housing captured by this variable.</p></li>
<li><p><span class="math inline">\(PPI\)</span>: represents the Property Price Index in Australia. The index is normalized with respect to the property prices in 2011-2012.</p></li>
</ul>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                                              
1 function (x, df1, df2, ncp, log = FALSE)    
2 {                                           
3     if (missing(ncp))                       
4         .Call(C_df, x, df1, df2, log)       
5     else .Call(C_dnf, x, df1, df2, ncp, log)
6 }                                           </code></pre>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="data-properties" class="level2">
<h2 class="anchored" data-anchor-id="data-properties">Data Properties</h2>
<p>The variables discussed above are illustrated in the figure below. Note that the logged variables trend upwards because they are expressed in their levels, while variables expressed in percentage change terms do not exhibit this behavior.</p>
<p>The dataset will be used in the sample consists quarterly data from 2003 Q3 to 2021 Q4, including 74 observations, plots of truncated dataset is shown as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>var_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(df)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">as.yearqtr</span>(<span class="fu">rownames</span>(df), <span class="at">format =</span> <span class="st">"%Y Q%q"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(df)){</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> date_range, <span class="at">y =</span> df[,j],,<span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(var_names[j]), <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fl">2.5</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(df[,j]),<span class="fu">max</span>(df[,j])))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="adf-tests" class="level3">
<h3 class="anchored" data-anchor-id="adf-tests">ADF Tests</h3>
<p>Next, I perform and display ADF test results on the variables. I report, for each variable, the difference level at which the ADF tests rejects the null that the series is non-stationary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>perform_adf_tests <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create an empty dataframe to store the results</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">character</span>(), <span class="at">TestType =</span> <span class="fu">character</span>(), </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">TestStatistic =</span> <span class="fu">numeric</span>(), <span class="at">PValue =</span> <span class="fu">numeric</span>(), </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over each column in the dataframe</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(df)) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove NA values from the column</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    column_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df[[col]])</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform ADF test for levels</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    adf_levels <span class="ot">&lt;-</span> tseries<span class="sc">::</span><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(column_data), <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if p-value is less than or equal to 0.05</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (adf_levels<span class="sc">$</span>p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) {</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="at">Variable =</span> col, <span class="at">TestType =</span> <span class="st">"Levels"</span>, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">TestStatistic =</span> adf_levels<span class="sc">$</span>statistic,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PValue =</span> adf_levels<span class="sc">$</span>p.value)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Perform ADF test for first difference</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>      adf_diff1 <span class="ot">&lt;-</span> tseries<span class="sc">::</span><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(<span class="fu">diff</span>(column_data)), <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if p-value is less than 0.05</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (adf_diff1<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">data.frame</span>(<span class="at">Variable =</span> col, <span class="at">TestType =</span> <span class="st">"First Difference"</span>, </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">TestStatistic =</span> adf_diff1<span class="sc">$</span>statistic,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">PValue =</span> adf_diff1<span class="sc">$</span>p.value)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform ADF test for second difference</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        adf_diff2 <span class="ot">&lt;-</span> tseries<span class="sc">::</span><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(<span class="fu">diff</span>(column_data, <span class="at">differences =</span> <span class="dv">2</span>)), <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">Variable =</span> col, <span class="at">TestType =</span> <span class="st">"Second Difference"</span>, </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">TestStatistic =</span> adf_diff2<span class="sc">$</span>statistic,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PValue =</span> adf_diff2<span class="sc">$</span>p.value)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the results dataframe</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>adf_test_results <span class="ot">&lt;-</span> <span class="fu">perform_adf_tests</span>(df)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(adf_test_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["TestType"],"name":[2],"type":["chr"],"align":["left"]},{"label":["TestStatistic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["PValue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Nominal GDP (log)","2":"Second Difference","3":"-6.191919","4":"0.01000000","_rn_":"Dickey-Fuller...1"},{"1":"Aggregate Consumption (log)","2":"First Difference","3":"-3.563888","4":"0.04262641","_rn_":"Dickey-Fuller...2"},{"1":"% Change in CPI, yoy","2":"First Difference","3":"-3.888444","4":"0.01961894","_rn_":"Dickey-Fuller...3"},{"1":"Quantity of new homes","2":"First Difference","3":"-3.854630","4":"0.02114484","_rn_":"Dickey-Fuller...4"},{"1":"House Price Index","2":"Second Difference","3":"-5.350314","4":"0.01000000","_rn_":"Dickey-Fuller...5"},{"1":"Owner-occupied home loan rates","2":"First Difference","3":"-4.099249","4":"0.01010607","_rn_":"Dickey-Fuller...6"},{"1":"M1 Money Supply (logs)","2":"First Difference","3":"-3.648050","4":"0.03540095","_rn_":"Dickey-Fuller...7"},{"1":"US FFR Max Target Rate","2":"Second Difference","3":"-4.029469","4":"0.01334623","_rn_":"Dickey-Fuller...8"},{"1":"RBA Target Cash Rate","2":"First Difference","3":"-4.021322","4":"0.01362264","_rn_":"Dickey-Fuller...9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="acf-plots" class="level3">
<h3 class="anchored" data-anchor-id="acf-plots">ACF Plots</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ACF-Plots-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">ACF Plots for our data</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pacf-plots" class="level3">
<h3 class="anchored" data-anchor-id="pacf-plots">PACF Plots</h3>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/PACF-Plots-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">PACF Plots for our data</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="model-and-hypothesis" class="level1">
<h1>Model and Hypothesis</h1>
<p>I employ a structural VAR model to assess the impact of monetary policy shocks on different housing indicators. The SVAR model with <span class="math inline">\(p\)</span> lags can be written as <span class="math display">\[
\begin{align}
&amp;B_0Y_t = B_0 + B_1 Y_{t-1} + \dots + B_p Y_{t-p} + U_t\\
&amp;U_{t}| Y_{t-1} \dots Y_{t-p} \sim _{iid} ( 0_N, I_N)
\end{align}
\]</span> where <span class="math inline">\(Y_t = [\log(M1_t), \Delta CPI_t, \log(c_t), \log(GDP_t), loanrate_t, AUCR_t, USFFR_t, nhouses_t, PPI_t]'\)</span>.</p>
<p><span class="math inline">\(B_0\)</span> is a <strong>structural matrix </strong> that captures the contemporaneous relationship between the variables in <span class="math inline">\(Y_t\)</span>. <span class="math inline">\(U_t\)</span> represents conditionally independent <strong>structural shocks</strong>.</p>
<p>The structural model can be estimated utilizing the information from its corresponding RF model <span class="math display">\[
\begin{align}
&amp;Y_t = A_0 + A_1 Y_{t-1} + \dots + A_p Y_{t-p} + E_t\\
&amp;E_{t}| Y_{t-1} \dots Y_{t-p} \sim _{iid} ( 0_N, \Sigma)
\end{align}
\]</span> where <span class="math inline">\(A_i = B_0^{-1}B_i\)</span> and <span class="math inline">\(B_0^{-1}I_N (B_0^{-1})'\)</span>.</p>
<p>The identification in the SVAR model can be achieved either by using some exclusion restrictions, sign restrictions, instrumental variables, or prior distribution. The next section will talk about the exact composition of the structural matrix and the conditions for identification.</p>
<section id="basic-model" class="level2">
<h2 class="anchored" data-anchor-id="basic-model">Basic Model</h2>
<section id="identification" class="level3">
<h3 class="anchored" data-anchor-id="identification">Identification</h3>
<p>I plan to use exclusion-restrictions to identify the structural matrix <span class="math inline">\(B_0\)</span>. In particular, I will employ the solution concept in <span class="citation" data-cites="waggoner2003b">D. Waggoner and Zha (<a href="#ref-waggoner2003b" role="doc-biblioref">2003</a>)</span> who use a normalization rule as an optimal solution to the local identification problem. I then employ the Gibbs sampler for a SVAR model with exclusion restrictions as in <span class="citation" data-cites="waggoner2003a">D. F. Waggoner and Zha (<a href="#ref-waggoner2003a" role="doc-biblioref">2003</a>)</span>.</p>
<p><span class="math display">\[ B_0 Y = B_+ X + U, \qquad \qquad U|X \sim \mathcal{MN}_{N \times T}(\textbf{0}_{N \times T}, I_T, I_N) \]</span> where</p>
<p><span class="math inline">\(B_0\)</span> is a <span class="math inline">\(N \times N\)</span> contemporaneous effects matrix.</p>
<p><span class="math inline">\(Y = [y_1, \dots, y_T]\)</span> is a <span class="math inline">\(N \times T\)</span> matrix of observations.</p>
<p><span class="math inline">\(B_+ = [B_d, B_1, \dots, B_p]\)</span> is a <span class="math inline">\(N \times K\)</span> matrix of autoregressive parameters, where <span class="math inline">\(K = Np + d\)</span> (<span class="math inline">\(d\)</span> is the number of deterministic terms; <span class="math inline">\(p\)</span> is the number of lags).</p>
<p><span class="math inline">\(X = [x_1, \dots, x_T]\)</span> is a <span class="math inline">\(K \times T\)</span> matrix of lagged observations where each <span class="math inline">\(x_t = (1, y_{t-1}, \dots, y_{t-p})'\)</span>.</p>
<p><span class="math inline">\(U = [u_1, \dots, u_T]\)</span> is a <span class="math inline">\(N \times T\)</span> matrix of structural shocks.</p>
<p>For convenience of coding and inference purposes, we consider a row-wise equation form as follows: <span class="math display">\[ B_{0[n.\cdot]} Y = B_{+n} X + U_n, \qquad \qquad U_n|X \sim \mathcal{N}(\mathbf{0}_T, I_T) \]</span></p>
<p>If <span class="math inline">\(r_n\)</span> denotes the number of elements in the <span class="math inline">\(n^{th}\)</span> row of <span class="math inline">\(B_0\)</span> that stay unrestricted, then we can further decompose <span class="math inline">\(B_{0[n.\cdot]}\)</span> into <span class="math inline">\(b_n\)</span> and <span class="math inline">\(V_n\)</span>.</p>
<p><span class="math inline">\(b_n\)</span> is a <span class="math inline">\(1 \times r_n\)</span> vector of unrestricted elements in the <span class="math inline">\(n^{th}\)</span> row of <span class="math inline">\(B_0\)</span>.</p>
<p><span class="math inline">\(V_n\)</span> is a <span class="math inline">\(r_n \times N\)</span> matrix which places elements of <span class="math inline">\(b_n\)</span> in the appropriate positions to impose the restrictions on <span class="math inline">\(B_0\)</span>.</p>
<p>Then, the row-wise equation form can be written as follows: <span class="math display">\[ b_n V_n Y = B_{+n} X + U_n, \qquad \qquad U_n|X \sim \mathcal{N}(\mathbf{0}_T, I_T) \]</span> Following <span class="citation" data-cites="waggoner2003a">D. F. Waggoner and Zha (<a href="#ref-waggoner2003a" role="doc-biblioref">2003</a>)</span> and <span class="citation" data-cites="arias2018a">Arias, Rubio‐Ramírez, and Waggoner (<a href="#ref-arias2018a" role="doc-biblioref">2018</a>)</span>, we define that <span class="math inline">\((B_+, B_0)\)</span> follow jointly a Normal-Generalised Normal (NGN) distribution denoted as <span class="math display">\[ p(B_+, B_0) \sim \mathcal{NGN}(B, \Omega, S, \nu)\]</span></p>
<p>if <span class="math inline">\(B_{+n}\)</span> follows a K-variate normal distribution given <span class="math inline">\(b_n\)</span> <span class="math display">\[ p(B_{+n}|b_n) = \mathcal{N}_k(b_nV_nB, \Omega) \]</span> with kernel <span class="math display">\[ p(B_{+n}|b_n) \propto \exp \left\{  -\frac{1}{2} \left( B_{+n} - b_nV_nB \right) \Omega^{-1}  \left( B_{+n} - b_nV_nB \right)' \right\} \]</span></p>
<p>for <span class="math inline">\(n = 1, \dots, N\)</span> and <span class="math inline">\(b_1, \dots, b_N\)</span> jointly have a distribution whose kernel is specified by <span class="math display">\[ p(b_1, \dots, b_N) \propto | \det(B_0) |^{\nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n S^{-1} V_n' b_n'  \right\} \]</span></p>
<p>The joint-distribution of <span class="math inline">\((B_+, B_0)\)</span> can then be written as <span class="math display">\[ p(B_0, B_+) = \left( \prod_{n=1}^N p(B_{+n}|b_n)\right) p(b_1, \dots, b_N) \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ltexclusion <span class="ot">=</span> <span class="cf">function</span>(usedata){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  BM.V        <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">"list"</span>,usedata<span class="sc">$</span>N)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>N){</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  BM.V[[n]]   <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(n),<span class="fu">matrix</span>(<span class="dv">0</span>,n,usedata<span class="sc">$</span>N<span class="sc">-</span>n))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>B0.initial    <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,usedata<span class="sc">$</span>N,usedata<span class="sc">$</span>N)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>N){</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  unrestricted               <span class="ot">=</span> <span class="fu">apply</span>(BM.V[[n]],<span class="dv">2</span>,sum)<span class="sc">==</span><span class="dv">1</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  B0.initial[n,unrestricted] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fu">sum</span>(unrestricted))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>B0Vlist       <span class="ot">=</span> <span class="fu">list</span>(<span class="at">B0.initial =</span> B0.initial, <span class="at">V =</span> BM.V)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prior-distribution" class="level3">
<h3 class="anchored" data-anchor-id="prior-distribution">Prior distribution</h3>
<p>Given this parameterisation, we can write down the kernel of the <strong>prior</strong> given hyperparameters <span class="math inline">\((\underline B, \underline \Omega, \underline S, \underline \nu)\)</span> as follows: <span class="math display">\[ | \det(B_0) |^{\underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \underline S^{-1} V_n' b_n'  \right\}  \exp \left\{  -\frac{1}{2}  \sum_{n=1}^N  \left( B_{+n} - b_nV_n \underline B \right) \underline \Omega^{-1}  \left( B_{+n} - b_nV_n \underline B \right)' \right\}  \]</span> This prior distribution has two key advantages. Firstly, it leads to a full-conditional posterior distributions that allow efficient sampling. This allows us to estimate the structural parameters of the SVAR model.</p>
<p>Secondly, it belongs to a class of reference prior distributions that are invariant to the pre-multiplication of the parameter matrices by a rotation matrix up to which the system is identified (see <span class="citation" data-cites="rr2010">Rubio-Ramirez, Waggoner, and Zha (<a href="#ref-rr2010" role="doc-biblioref">2010</a>)</span>). This allows us to conduct a proper Bayesian treatment of this model given the identification above.</p>
<!-- $$ -->
<!-- \begin{align*} -->
<!--   B_0 = -->
<!--   \begin{bmatrix} -->
<!--     1 & 0 & 0 & 0  & 0  & 0  & 0  & 0  & 0  \\ -->
<!--     b_{21} & 1 & & & & & & & \\ -->
<!--     b_{31} & b_{32} & 1 & & & & & & \\ -->
<!--     b_{41} & b_{42} &  & 1 & & & & & \\ -->
<!--     b_{51} & b_{52} & & & 1 & & & & \\ -->
<!--     b_{61} & b_{62} & & & & 1 & & & \\ -->
<!--     b_{71} & b_{72} & & & & & 1 & & \\ -->
<!--     b_{81} & b_{82} & & & & & & 1 & \\ -->
<!--     b_{91} & b_{92} & & & & & & & 1 -->
<!--   \end{bmatrix} -->
<!-- \end{align*} -->
<!-- $$ -->
<div class="cell">

</div>
<section id="calibration-of-the-prior" class="level4">
<h4 class="anchored" data-anchor-id="calibration-of-the-prior">Calibration of the prior</h4>
<ul>
<li><span class="math inline">\(\underline \nu = N\)</span> is a commonly chosen value as it implies that the generalised-normal part is equivalent to a <span class="math inline">\(r_n\)</span>-variate normal with the mean equal to a vector of zeros and the covariance matrix equal to <span class="math inline">\(\underline S\)</span>.</li>
<li><span class="math inline">\(\underline S = \kappa_3 I_N\)</span> implies that the covariances across the rows of <span class="math inline">\(B_0\)</span> is zero, and the variance of each row is homoskedastic (constant). <span class="math inline">\(\kappa_3\)</span> can be interpreted as a contemporaneous effects shrinkage and is set to 10.</li>
<li><span class="math inline">\(\underline B = [0_{N \times 1} \; \kappa_4 I_N \; 0_{N \times (p-1)N}]\)</span> implies an AR1 process for the structural VAR at the prior mean. In this calibration, <span class="math inline">\(\kappa_4 = 1\)</span>, the AR1 process is a random walk process.</li>
<li><span class="math inline">\(\underline \Omega = \begin{pmatrix} \kappa_2 &amp; 0\\ 0 &amp; \kappa_1 I_{Np} \end{pmatrix}\)</span> is the prior covariance matrix. It is taken to be a diagonal matrix with the diagonal elements set as the Litterman prior. <span class="math inline">\(\kappa_2\)</span> represents the constant term shrinkage and is set to 10. <span class="math inline">\(\kappa_1\)</span> represents the autoregressive slope shrinkage and is set to 0.1.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A function that computes and stores all the prior distribution components given a parameter list input</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>prior     <span class="ot">=</span> <span class="cf">function</span>(parameters, usedata){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  priors  <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">B       =</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,usedata<span class="sc">$</span>N), parameters<span class="sc">$</span>kappa4<span class="sc">*</span><span class="fu">diag</span>(usedata<span class="sc">$</span>N), <span class="fu">matrix</span>(<span class="dv">0</span>, usedata<span class="sc">$</span>N, (usedata<span class="sc">$</span>p<span class="dv">-1</span>)<span class="sc">*</span>usedata<span class="sc">$</span>N)), <span class="co"># random walk prior</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Omega   =</span> <span class="fu">diag</span>(<span class="fu">c</span>(parameters<span class="sc">$</span>kappa2,parameters<span class="sc">$</span>kappa1<span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,usedata<span class="sc">$</span>N))),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Omega = diag(c(parameters$kappa2,parameters$kappa1*rep(1,usedata$N*usedata$p))),</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">S       =</span> parameters<span class="sc">$</span>kappa3<span class="sc">*</span><span class="fu">diag</span>(usedata<span class="sc">$</span>N),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nu      =</span> usedata<span class="sc">$</span>N</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the priors</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa1    =</span> .<span class="dv">1</span>,       <span class="co"># autoregressive slope shrinkage</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa2    =</span> <span class="dv">10</span>,      <span class="co"># constant term shrinkage</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa3    =</span> <span class="dv">10</span>,      <span class="co"># contemporaneous effects shrinkage</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa4    =</span> <span class="dv">1</span>,       <span class="co"># VAR prior persistence</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">S         =</span> <span class="dv">5000</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">S.burnin  =</span> <span class="dv">100</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">h         =</span> <span class="dv">8</span>        <span class="co"># forecast horizon</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also calibrate the number of draws <span class="math inline">\(S = 5000\)</span> for any sampling, while the <span class="math inline">\(S.burnin = 100\)</span> represents the number of draws that are sampled first and then discarded.</p>
</section>
</section>
<section id="likelihood-function" class="level3">
<h3 class="anchored" data-anchor-id="likelihood-function">Likelihood Function</h3>
<p>The conditional normality of the error term allows us to write the kernel of the likelihood function and show that it can be expressed as a NGN distribution. <span class="math display">\[
\begin{align*}
    &amp;L(B_+, B_0|Y,X) \propto | \det(B_0^{-1}B_0^{-1'})|^{-\frac{T}{2}} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left(b_n V_n Y - B_{+n} X \right) \left( b_n V_n Y - B_{+n} X  \right)' \right\}\\
    &amp; = | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n Y Y' V_n' b_n' - 2 b_n V_n Y X' B_{+n}' + B_{+n} X X' B_{+n}' \right) \right\}\\
    &amp; = | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n Y Y' V_n' b_n' + B_{+n} X X' B_{+n}' - 2 b_n V_n Y X' (XX')^{-1} (XX') B_{+n}' \right. \right. \\
    &amp; \left. \left. + b_n V_n Y X' (XX')^{-1} (XX') (XX')^{-1} XY'V_n'b_n' - b_n V_n Y X' (XX')^{-1} (XX') (XX')^{-1} XY'V_n'b_n' \right) \right\}\\
    &amp; = | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n [ YY' - YX'(XX')^{-1}XY'] V_n' b_n'  + B_{+n} X X' B_{+n}' \right. \right. \\
    &amp; \left. \left. - 2 b_n V_n Y X' (XX')^{-1} (XX') B_{+n}' + b_n V_n Y X' (XX')^{-1} XY' V_n' b_n' \right) \right\}\\
    &amp; \text{}\\
    &amp; \text{Let $\hat A = YX' (XX')^{-1} $, then we can simplify}\\
    &amp; \text{}\\
    &amp; =  | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n [ YY' - \hat A XY'] V_n' b_n'  + B_{+n} X X' B_{+n}' - 2 b_n V_n \hat A (XX') B_{+n}' \right. \right.\\ &amp; \left. \left. + b_n V_n \hat A XY' V_n' b_n' \right) \right\}\\
    &amp; =  | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n [ YY' - \hat A XY'] V_n' b_n'  + (B_{+n} - b_n V_n \hat A) X X' (B_{+n} - b_n V_n \hat A)' \right) \right\}\\
    &amp; =  | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n [ YY' - \hat A XY'] V_n' b_n' \right\} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N (B_{+n} - b_n V_n \hat A) X X' (B_{+n} - b_n V_n \hat A)' \right\}
\end{align*}
\]</span></p>
<p>Comparing this with the general NGN kernel, we can write that</p>
<p><span class="math display">\[ L(B_+, B_0|Y, X) = \mathcal{NGN}(\tilde B, \tilde \Omega, \tilde S, \tilde \nu) \]</span> where</p>
<p><span class="math display">\[ \tilde B = \hat A, \quad \tilde \Omega = (XX')^{-1}, \quad \tilde S = ( YY' - \hat A XY')^{-1}, \quad \tilde \nu = T + N. \]</span> Hence, we have shown that the likelihood function follows a NGN distribution.</p>
</section>
<section id="posterior-distribution" class="level3">
<h3 class="anchored" data-anchor-id="posterior-distribution">Posterior Distribution</h3>
<p>The prior and the likelihood can be used to obtain the posterior as follows:</p>
<p><span class="math display">\[
\begin{align*}
    &amp; p(B_+, B_0|Y, X)  \propto L(B_+, B_0|Y, X) p(B_0, B_+)\\
    &amp; = | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left(b_n V_n Y - B_{+n} X \right) \left( b_n V_n Y - B_{+n} X  \right)' \right\}\\
    &amp; \times | \det(B_0) |^{\underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \underline S^{-1} V_n' b_n'  \right\}  \exp \left\{  -\frac{1}{2}  \sum_{n=1}^N  \left( B_{+n} - b_nV_n \underline B \right) \underline \Omega^{-1}  \left( B_{+n} - b_nV_n \underline B \right)' \right\} \\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left(b_n V_n Y Y' V_n' b_n' - 2 b_n V_n Y X' B_{+n}' + B_{+n} X X' B_{+n}' \right) \right.\\
    &amp; \left. + b_n V_n \underline S^{-1} V_n' b_n' + B_{+n} \underline \Omega^{-1} B_{+n}' - 2 b_n V_n \underline B \underline \Omega^{-1} B_{+n}' + b_n V_n \underline B \underline \Omega^{-1} \underline B' V_n' b_n' \right\}\\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n [ YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B'] V_n' b_n' - 2 b_n V_n [ YX' + \underline B \underline \Omega^{-1} ] B_{+n}' \right.\\
    &amp; \left. + B_{+n} [ XX' + \underline \Omega^{-1} ] B_{+n}' \right\}\\ &amp; \text{}\\
    &amp; \text{ Let $ \bar \Omega = (XX' + \underline \Omega^{-1})^{-1} $, then we can write}\\ &amp; \text{}\\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n [ YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B'] V_n' b_n' - 2 b_n V_n [ YX' + \underline B \underline \Omega^{-1} ] \bar \Omega \bar \Omega^{-1} B_{+n}' \right.\\
    &amp; \left. + B_{+n} \bar \Omega^{-1} B_{+n}' \right\}\\
    &amp; \text{}\\
    &amp; \text{ Let $ \bar B = (YX' + \underline B \underline \Omega^{-1}) \bar \Omega $, then we can write}\\ &amp; \text{}\\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n [ YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B' - \bar B \bar \Omega^{-1} \bar B' ] V_n' b_n'  \right.\\
    &amp; \left.  + b_n V_n  \bar B \bar \Omega^{-1} \bar B' V_n' b_n' - 2 b_n V_n \bar B \bar \Omega^{-1} B_{+n}' + B_{+n} \bar \Omega^{-1} B_{+n}' \right\}\\
    &amp; \text{}\\
    &amp; \text{ Define $ \bar S = (YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B' - \bar B \bar \Omega^{-1} \bar B')^{-1} $, then we can write}\\ &amp; \text{}\\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \bar S^{-1} V_n' b_n'  + (B_{+n} - b_n V_n \bar B) \bar \Omega^{-1} (B_{+n} - b_n V_n \bar B)' \right\}\\
    &amp;  = | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \bar S^{-1} V_n' b_n'  \right\} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N (B_{+n} - b_n V_n \bar B) \bar \Omega^{-1} (B_{+n} - b_n V_n \bar B)' \right\}
\end{align*}
\]</span> Thus, <span class="math display">\[ p(B_+, B_0|Y,X) \sim \mathcal{NGN}(\bar B, \bar \Omega, \bar S, \bar \nu) \]</span> where the first three parameters are defined above and <span class="math inline">\(\bar \nu = T + \underline \nu\)</span>.</p>
<p>The following <code>R</code> function uses the prior and information contained in data to compute and store (as a list) the set of posterior parameters for our model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>posterior     <span class="ot">=</span> <span class="cf">function</span>(priors, usedata){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  Omega.inv   <span class="ot">=</span> <span class="fu">solve</span>(priors<span class="sc">$</span>Omega)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  Omega.post.inv <span class="ot">=</span> usedata<span class="sc">$</span>X<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> Omega.inv</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  Omega.post  <span class="ot">=</span> <span class="fu">solve</span>( Omega.post.inv )</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  B.post      <span class="ot">=</span> (usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv) <span class="sc">%*%</span> Omega.post</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  S.post      <span class="ot">=</span> <span class="fu">solve</span>(usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> <span class="fu">solve</span>(priors<span class="sc">$</span>S) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span><span class="fu">t</span>(priors<span class="sc">$</span>B) <span class="sc">-</span> B.post<span class="sc">%*%</span>Omega.post.inv<span class="sc">%*%</span><span class="fu">t</span>(B.post) )</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  nu.post     <span class="ot">=</span> <span class="fu">ncol</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> priors<span class="sc">$</span>nu</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  posteriors  <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">B           =</span> B.post,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Omega       =</span> Omega.post,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">S           =</span> S.post,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">nu          =</span> nu.post</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following is the code to sample using the Gibbs sampler. More information on the specifics of this code will be added soon.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>posteriorSimulations  <span class="ot">=</span> <span class="cf">function</span>(parameters, posteriors, B0Vlist, N){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  t0                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  B0.posterior        <span class="ot">=</span> <span class="fu">rgn</span>(<span class="at">n=</span>parameters<span class="sc">$</span>S.burnin, <span class="at">S.inv=</span><span class="fu">solve</span>(posteriors<span class="sc">$</span>S), <span class="at">nu=</span>posteriors<span class="sc">$</span>nu, <span class="at">V=</span>B0Vlist<span class="sc">$</span>V, <span class="at">B0.initial=</span>B0Vlist<span class="sc">$</span>B0.initial)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  t1                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  (t1<span class="sc">-</span>t0)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling B0 from the posterior distribution using Gibbs</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  t0                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  B0.posterior        <span class="ot">=</span> <span class="fu">rgn</span>(<span class="at">n=</span>parameters<span class="sc">$</span>S, <span class="at">S.inv=</span><span class="fu">solve</span>(posteriors<span class="sc">$</span>S), <span class="at">nu=</span>posteriors<span class="sc">$</span>nu, <span class="at">V=</span>B0Vlist<span class="sc">$</span>V, <span class="at">B0.initial=</span>B0.posterior[,,parameters<span class="sc">$</span>S.burnin])</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  t1                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  (t1<span class="sc">-</span>t0)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normalisation</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  B0.hat              <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>((posteriors<span class="sc">$</span>nu<span class="sc">-</span>N)<span class="sc">*</span>posteriors<span class="sc">$</span>S))                   <span class="co"># normalisation using this B0.hat should work</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  BM.B0.posterior     <span class="ot">=</span> <span class="fu">normalize.Gibbs.output.parallel</span>(B0.posterior,<span class="at">B0.hat=</span>B0.hat)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  t2                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  (t2<span class="sc">-</span>t1)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample B+ from the normal conditional posterior</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  t2                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  BM.Bp.posterior     <span class="ot">=</span> <span class="fu">rnorm.ngn</span>(BM.B0.posterior, <span class="at">B=</span>posteriors<span class="sc">$</span>B,<span class="at">Omega=</span>posteriors<span class="sc">$</span>Omega)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  t3                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  (t3<span class="sc">-</span>t2)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">B0.posterior   =</span> BM.B0.posterior, <span class="at">Bp.posterior =</span> BM.Bp.posterior)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function computes the sample average of the <span class="math inline">\(B_0\)</span> and <span class="math inline">\(B_+\)</span> matrices obtained from each sampling step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>posteriorMeans <span class="ot">=</span> <span class="cf">function</span>(Bposteriors){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  Bposteriors.means <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">B0 =</span> <span class="fu">rowMeans</span>(Bposteriors<span class="sc">$</span>B0.posterior, <span class="at">dims =</span> <span class="dv">2</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bp =</span> <span class="fu">rowMeans</span>(Bposteriors<span class="sc">$</span>Bp.posterior, <span class="at">dims =</span> <span class="dv">2</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-run" class="level3">
<h3 class="anchored" data-anchor-id="simulation-run">Simulation Run</h3>
<p>The following code generates artificial data containing 1000 observations from a bi-variate Gaussian random walk process with the covariance matrix equal to the identity matrix of order 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sim.p <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>sim.T <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>sim.N <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>sim.K <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> sim.N<span class="sc">*</span>sim.p</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>sim.Y           <span class="ot">=</span> <span class="fu">arima.sim</span>(<span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)), <span class="at">n =</span> sim.T <span class="sc">+</span> sim.p<span class="dv">-1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span><span class="dv">1</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>sim.N){</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  sim.Y         <span class="ot">=</span> <span class="fu">rbind</span>(sim.Y, <span class="fu">arima.sim</span>(<span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)), <span class="at">n =</span> sim.T <span class="sc">+</span> sim.p<span class="dv">-1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>sim.X           <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,sim.T)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>sim.p){</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  sim.X         <span class="ot">=</span> <span class="fu">rbind</span>(sim.X, sim.Y[,(sim.p<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>i)<span class="sc">:</span>(<span class="fu">ncol</span>(sim.Y)<span class="sc">-</span>i)])</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>sim.Y           <span class="ot">=</span> sim.Y[,<span class="sc">-</span>sim.p]</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>artificialdata  <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p =</span> sim.p, <span class="at">N =</span> sim.N, <span class="at">K =</span> sim.K, <span class="at">Y =</span> sim.Y, <span class="at">X =</span> sim.X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We obtain a list of simulation priors and posteriors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sim.priors      <span class="ot">=</span> <span class="fu">prior</span>(parameters, artificialdata)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sim.posteriors  <span class="ot">=</span> <span class="fu">posterior</span>(sim.priors, artificialdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We create a list of <span class="math inline">\(V_n\)</span> and <span class="math inline">\(b_n\)</span> corresponding to a lower triangular exclusion restriction on <span class="math inline">\(B_0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sim.B0Vlist   <span class="ot">=</span> <span class="fu">ltexclusion</span>(artificialdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We sample the <span class="math inline">\(B_0\)</span> and <span class="math inline">\(B_p\)</span> posteriors using the Gibbs sampler, and save the data for future use.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sim.Bposteriors.means <span class="ot">=</span> <span class="fu">posteriorMeans</span>(sim.Bposteriors)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sim_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(sim.Bposteriors.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{cc}
1.007094 &amp; 0.000000\\
-0.037662 &amp; 1.000047\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<p>We can see that the computed <span class="math inline">\(B_0\)</span> covariance matrix is numerically identical to an identity matrix.</p>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sim_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(sim.Bposteriors.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccc}
0.2276255 &amp; 0.9989406 &amp; -0.0071993\\
-0.1389968 &amp; -0.0461782 &amp; 0.9791025\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<p>The first column of <span class="math inline">\(B_+\)</span> represents the posterior mean of the constant term. The values are small and close to zero. The rest of the <span class="math inline">\(B_+\)</span> matrix represents the autoregressive matrix. Its posterior mean is numerically equal to an identity matrix.</p>
</section>
<section id="data-results" class="level3">
<h3 class="anchored" data-anchor-id="data-results">Data Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Y is N by T; X is K by T</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">4</span>                                   <span class="co"># set a number of lags included</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">ncol</span>(df)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> N<span class="sc">*</span>p</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">t</span>(df[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(df),])</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fu">ncol</span>(Y))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  X    <span class="ot">=</span> <span class="fu">rbind</span>(X,<span class="fu">t</span>(df[((p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(df))<span class="sc">-</span>i,]))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">N=</span>N,<span class="at">K=</span>K,<span class="at">Y=</span>Y,<span class="at">X=</span>X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>priors     <span class="ot">=</span> <span class="fu">prior</span>(parameters, mydata)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>posteriors <span class="ot">=</span> <span class="fu">posterior</span>(priors, mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>B0Vlist       <span class="ot">=</span> <span class="fu">ltexclusion</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Bposterior.means <span class="ot">=</span> <span class="fu">posteriorMeans</span>(Bposteriors)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(Bposterior.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccc}
26.4940518 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
-0.3380425 &amp; 24.6273230 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
-1.2296512 &amp; -0.9983330 &amp; 1.6722032 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
-0.1233031 &amp; -2.4537432 &amp; -0.2632202 &amp; 19.6985309 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
2.1051513 &amp; -5.0613220 &amp; -0.4257930 &amp; -0.7689391 &amp; 0.6126037 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
-0.2150772 &amp; -1.2957925 &amp; -0.3869991 &amp; -1.7047604 &amp; 0.0374219 &amp; 3.4011970 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
1.0154503 &amp; 1.5283911 &amp; 0.1711357 &amp; -0.3195497 &amp; -0.1116862 &amp; 0.2279021 &amp; 23.613955 &amp; 0.000000 &amp; 0.000000\\
-0.4246873 &amp; -0.4641174 &amp; -0.4620483 &amp; 1.6636036 &amp; 0.0280645 &amp; 0.1028981 &amp; 2.499467 &amp; 2.957524 &amp; 0.000000\\
-0.8187946 &amp; -0.2578413 &amp; -0.1325210 &amp; -1.0640772 &amp; 0.0538243 &amp; -0.6299644 &amp; 4.258376 &amp; -1.312915 &amp; 4.285367\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(Bposterior.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccccccccccccccccccccccccccccccc}
0.0313870 &amp; 26.4569415 &amp; -0.0327681 &amp; 0.1819720 &amp; 0.0568686 &amp; -0.0033431 &amp; 0.0813427 &amp; 0.0247433 &amp; 0.0665232 &amp; 0.0271708 &amp; -0.0096913 &amp; -0.0105761 &amp; -0.0997355 &amp; 0.0070901 &amp; -0.0206845 &amp; -0.0016423 &amp; 0.0065069 &amp; -0.0372623 &amp; -0.0138630 &amp; -0.0024978 &amp; -0.0034855 &amp; -0.0098862 &amp; 0.0026398 &amp; 0.0291279 &amp; -0.0112187 &amp; -0.0003108 &amp; -0.0098788 &amp; -0.0187000 &amp; -0.0009047 &amp; -0.0020087 &amp; -0.0139349 &amp; 0.0006616 &amp; -0.0040534 &amp; -0.0138101 &amp; 0.0026386 &amp; -0.0037407 &amp; -0.0121108\\
0.3118403 &amp; -0.3491077 &amp; 24.5944735 &amp; 0.1658414 &amp; 0.0323675 &amp; -0.0290125 &amp; 0.0056105 &amp; 0.0415607 &amp; 0.0906851 &amp; -0.0069232 &amp; -0.0035971 &amp; 0.0001838 &amp; -0.1478081 &amp; 0.0035363 &amp; 0.0108540 &amp; -0.0142010 &amp; 0.0092315 &amp; -0.0701845 &amp; -0.0171378 &amp; 0.0015312 &amp; 0.0007600 &amp; 0.0347196 &amp; 0.0029587 &amp; 0.0386143 &amp; -0.0072547 &amp; 0.0033597 &amp; -0.0175452 &amp; 0.0032212 &amp; 0.0015009 &amp; -0.0000570 &amp; 0.0105633 &amp; -0.0001803 &amp; -0.0233427 &amp; 0.0006515 &amp; 0.0048423 &amp; -0.0107779 &amp; 0.0014931\\
0.1177781 &amp; -1.2767720 &amp; -1.0518524 &amp; 1.2094425 &amp; 0.0761097 &amp; 0.1008272 &amp; 0.3125345 &amp; 0.0568971 &amp; 0.0034985 &amp; 0.0131132 &amp; -0.0147020 &amp; -0.0162680 &amp; -0.1390088 &amp; 0.0155970 &amp; -0.0683094 &amp; -0.0071123 &amp; 0.0109398 &amp; 0.0529946 &amp; -0.0419230 &amp; -0.0062477 &amp; -0.0088432 &amp; -0.0476680 &amp; 0.0108559 &amp; -0.0393847 &amp; -0.0277866 &amp; 0.0070099 &amp; -0.0224318 &amp; -0.0063652 &amp; -0.0050057 &amp; 0.0001287 &amp; -0.0595951 &amp; 0.0014401 &amp; 0.0056259 &amp; -0.0047971 &amp; 0.0029218 &amp; -0.0094402 &amp; 0.0033100\\
2.0868301 &amp; 0.0268110 &amp; -2.3415207 &amp; -0.5485285 &amp; 19.6611083 &amp; -0.0442322 &amp; -0.0845858 &amp; 0.2310404 &amp; -0.0813849 &amp; -0.3370252 &amp; 0.0433237 &amp; 0.0237512 &amp; -0.1349206 &amp; -0.0462332 &amp; 0.0116183 &amp; -0.0349516 &amp; 0.0524911 &amp; 0.0241447 &amp; -0.0193755 &amp; 0.0197654 &amp; 0.0125298 &amp; 0.0119089 &amp; -0.0192205 &amp; 0.0006222 &amp; 0.0127275 &amp; 0.0204818 &amp; 0.0608027 &amp; 0.0373901 &amp; 0.0140173 &amp; 0.0128423 &amp; 0.0298812 &amp; -0.0061018 &amp; -0.0028882 &amp; 0.0337124 &amp; 0.0078184 &amp; 0.0535644 &amp; 0.0537298\\
1.1897387 &amp; 2.2106340 &amp; -5.0088842 &amp; -0.1006487 &amp; -0.6205730 &amp; 0.9293977 &amp; -0.3167683 &amp; 0.2770154 &amp; 0.0190907 &amp; -0.2095057 &amp; 0.0295785 &amp; 0.0099102 &amp; -0.1273959 &amp; 0.0251088 &amp; -0.2841019 &amp; -0.0102570 &amp; 0.0720094 &amp; -0.0294874 &amp; -0.0196386 &amp; 0.0094809 &amp; 0.0039184 &amp; -0.0200953 &amp; 0.0048169 &amp; -0.1268620 &amp; 0.0221273 &amp; 0.0260895 &amp; 0.0231599 &amp; 0.0156990 &amp; 0.0058236 &amp; 0.0014680 &amp; 0.0285972 &amp; -0.0003972 &amp; 0.0682792 &amp; 0.0227194 &amp; 0.0194514 &amp; 0.0277990 &amp; -0.0022622\\
2.7099515 &amp; -0.1194878 &amp; -1.1686990 &amp; -0.5450012 &amp; -1.6039826 &amp; 0.1280864 &amp; 3.3777491 &amp; 0.0043075 &amp; 0.2080657 &amp; -0.1297811 &amp; 0.0257322 &amp; 0.0273878 &amp; -0.1050657 &amp; 0.0153163 &amp; -0.0464076 &amp; -0.0742932 &amp; 0.0086350 &amp; 0.0901584 &amp; -0.0865690 &amp; 0.0136484 &amp; 0.0147759 &amp; -0.0439244 &amp; 0.0099363 &amp; -0.0665364 &amp; -0.0511785 &amp; 0.0017058 &amp; -0.0831901 &amp; -0.0057465 &amp; 0.0042236 &amp; 0.0067384 &amp; 0.0317697 &amp; 0.0067574 &amp; -0.0063785 &amp; 0.0016346 &amp; 0.0020328 &amp; -0.0565111 &amp; 0.0148611\\
0.3805479 &amp; 1.0797164 &amp; 1.5590079 &amp; 0.0977334 &amp; -0.3803556 &amp; -0.1717108 &amp; 0.0276471 &amp; 23.6592986 &amp; 0.0333069 &amp; 0.0626810 &amp; 0.0147699 &amp; 0.0101397 &amp; 0.0276574 &amp; -0.0074707 &amp; 0.0799705 &amp; 0.0524361 &amp; 0.0169888 &amp; 0.0156272 &amp; -0.0238062 &amp; 0.0061966 &amp; 0.0030899 &amp; 0.0070784 &amp; 0.0020508 &amp; -0.0237472 &amp; 0.0043300 &amp; 0.0055746 &amp; 0.0267517 &amp; -0.0003354 &amp; 0.0009739 &amp; 0.0023843 &amp; -0.0005320 &amp; 0.0007199 &amp; 0.0023859 &amp; 0.0078429 &amp; 0.0041326 &amp; 0.0255033 &amp; -0.0155662\\
4.2115891 &amp; -0.3653257 &amp; -0.3237969 &amp; -0.4357207 &amp; 1.8592501 &amp; -0.1032033 &amp; 0.1499585 &amp; 2.5088269 &amp; 3.1525256 &amp; -0.3110547 &amp; 0.0101621 &amp; 0.0273494 &amp; 0.0283019 &amp; 0.0557167 &amp; 0.1173075 &amp; -0.1323711 &amp; 0.0077811 &amp; -0.0777921 &amp; -0.0529169 &amp; 0.0041631 &amp; 0.0140670 &amp; 0.0557519 &amp; 0.0267265 &amp; 0.0085934 &amp; -0.0411494 &amp; 0.0068860 &amp; -0.0935479 &amp; -0.0289034 &amp; 0.0000931 &amp; 0.0052338 &amp; -0.0055452 &amp; 0.0152012 &amp; -0.0315718 &amp; -0.0246428 &amp; 0.0040602 &amp; -0.1188626 &amp; -0.0266781\\
-0.8375270 &amp; -0.8518276 &amp; -0.2703360 &amp; -0.0307538 &amp; -1.0175083 &amp; 0.1413908 &amp; 0.5599471 &amp; 4.2092707 &amp; -1.1793020 &amp; 3.7460968 &amp; -0.0043574 &amp; -0.0070958 &amp; -0.1730547 &amp; -0.0072167 &amp; -0.0199354 &amp; -0.1521636 &amp; -0.0083810 &amp; 0.0483988 &amp; -0.1605946 &amp; -0.0001436 &amp; -0.0023327 &amp; -0.0829103 &amp; -0.0038030 &amp; -0.0505250 &amp; -0.0725365 &amp; -0.0023602 &amp; 0.0798322 &amp; -0.0853690 &amp; 0.0009145 &amp; -0.0011304 &amp; -0.0208605 &amp; -0.0027458 &amp; -0.0343701 &amp; -0.0498913 &amp; -0.0043068 &amp; -0.0075059 &amp; -0.0253156\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
</section>
</section>
<section id="extended-model" class="level2">
<h2 class="anchored" data-anchor-id="extended-model">Extended Model</h2>
<p>In the extended model, I will estimate the hyperparameters rather than setting them exogenously. Such estimation procedure often improves the fit of the model especially because the results can be sensitive to the parameterisation of the hyperparameters. In particular, I estimate <span class="math inline">\((\kappa_0, \kappa_+)\)</span> such that <span class="math inline">\(\underline S = \kappa_0 I_N\)</span> and <span class="math inline">\(\underline \Omega = \kappa_+ I_K\)</span>.</p>
<p>I postulate the following prior distributions for the hyperparameters: <span class="math display">\[
\begin{align*}
    \kappa_0 | \underline s_{\kappa_0}, \underline \nu_{\kappa_0} \sim \mathcal{IG}2(\underline s_{\kappa_0}, \underline \nu_{\kappa_0})  &amp;&amp; \kappa_+ | \underline s_{\kappa_+}, \underline \nu_{\kappa_+} \sim \mathcal{G}(2 \underline s_{\kappa_+}, \frac{1}{2} \underline \nu_{\kappa_+})
  \end{align*}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ext.priors <span class="ot">=</span> <span class="cf">function</span>(parameters,usedata){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  ext.prior <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa0.s =</span> .<span class="dv">1</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa0.nu =</span> <span class="dv">1</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappap.s =</span> .<span class="dv">1</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappap.nu =</span> <span class="dv">1</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">B       =</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,usedata<span class="sc">$</span>N), <span class="fu">diag</span>(usedata<span class="sc">$</span>N), <span class="fu">matrix</span>(<span class="dv">0</span>, usedata<span class="sc">$</span>N, (usedata<span class="sc">$</span>p<span class="dv">-1</span>)<span class="sc">*</span>usedata<span class="sc">$</span>N)), <span class="co"># random walk prior</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Omega   =</span> parameters<span class="sc">$</span>kappa2 <span class="sc">*</span> <span class="fu">diag</span>(usedata<span class="sc">$</span>K),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">S       =</span> parameters<span class="sc">$</span>kappa3<span class="sc">*</span><span class="fu">diag</span>(usedata<span class="sc">$</span>N),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">nu      =</span> usedata<span class="sc">$</span>N</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, we have <span class="math display">\[
  \begin{align*}
    p(B_{+n}|b_n, \kappa_+) = \mathcal{N}_k (b_n V_n B, \kappa_+ \Omega) &amp;&amp; p(b_n| \kappa_0) = \mathcal{N}_{r_n}(0, \kappa_0 S)
  \end{align*}
\]</span> Thus, posteriors <span class="math display">\[
\begin{align*}
    &amp; p(\kappa_0 | Y, X, B_0) \propto p(B_0|\kappa_0) p(\kappa_0 | \underline s_{\kappa_0}, \underline \nu_{\kappa_0} )\\
    &amp; \propto \prod_{n=1}^{N}\left(\kappa_0^{-\frac{1}{2}}\right)^{r_n} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n (\kappa_0 I_N)^{-1} V_n' b_n'  \right\} \cdot \kappa_0^{-\frac{\underline \nu_{\kappa_0}+2}{2}} \exp \left\{  -\frac{\underline s_{\kappa_0}}{2 \kappa_0} \right\}\\
    &amp; \propto \kappa_0^{ -\frac{\underline \nu_{\kappa_0} + 2 + \sum_{n=1}^{N}r_n}{2}} \cdot \exp \left\{  -\frac{1}{2 \kappa_0} \sum_{n=1}^N b_n V_n V_n' b_n' + \underline s_{\kappa_0} \right\}\\
  \end{align*}
  \]</span> This gives <span class="math display">\[ \bar s_{\kappa_0} =  \sum_{n=1}^N b_n V_n V_n' b_n' + \underline s_{\kappa_0}. \]</span> <span class="math display">\[ \bar \nu_{\kappa_0} = \underline \nu_{\kappa_0} +\sum_{n=1}^{N}r_n \]</span> Also, <span class="math display">\[
  \begin{align*}
    &amp; p(\kappa_+ | Y, X, B_+, B_0, \kappa_0) \propto p(B_+|\kappa_+, B_0, \kappa_0) p(\kappa_+ | \underline s_{\kappa_+}, \underline \nu_{\kappa_+} )\\
    &amp; \propto \kappa_+^{-\frac{KN}{2}} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N (B_{+n} - b_n V_n \underline B) (\kappa_+ I_{K})^{-1} (B_{+n} - b_n V_n \underline B)'  \right\} \cdot \kappa_+^{-\frac{\underline \nu_{\kappa_+} + 2}{2}} \exp \left\{  -\frac{ \kappa_+}{2 \underline s_{\kappa_+}} \right\}\\
    &amp; = \kappa_+^{-\frac{\underline \nu_{\kappa_+} + KN}{2} - 1} \cdot \exp \left\{  -\frac{1}{2} \left( (B_{+n} - b_n V_n \underline B)  (B_{+n} - b_n V_n \underline B)' \cdot \frac{1}{\kappa_+} + \frac{1}{\underline s_{\kappa_+}} \kappa_+  \right) \right\}\\
  \end{align*}
  \]</span> This gives <span class="math display">\[ \lambda = -\frac{\underline \nu_{\kappa_+} + KN}{2} \]</span> <span class="math display">\[ \chi =  \sum_{n=1}^N  (B_{+n} - b_n V_n \underline B)  (B_{+n} - b_n V_n \underline B)' \]</span> <span class="math display">\[  \Psi = \frac{1}{\underline s_{\kappa_+}} \]</span></p>
<p>A structure function is written that creates matrices to store draws of <span class="math inline">\(\{\kappa_0^{(s)}, \kappa_+^{(s)}, B_0^{(s)}, B_+^{(s)}\}_{s =1}^{S}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>  init.struct <span class="ot">=</span> <span class="cf">function</span>(usedata,S){</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    kappa0 <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(<span class="dv">1</span>,S))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    kappa0[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    kappap <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, S)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    kappap[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    B0.post <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(usedata<span class="sc">$</span>N,usedata<span class="sc">$</span>N,S))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    Bp.post <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(usedata<span class="sc">$</span>N,usedata<span class="sc">$</span>K,S))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">kappa0 =</span> kappa0, <span class="at">kappap =</span> kappap, <span class="at">B0.post =</span> B0.post, <span class="at">Bp.post =</span> Bp.post)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sampling function is given below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ext.sampling <span class="ot">=</span> <span class="cf">function</span>(parameters, struct, priors, usedata){</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  B0Vlist.initial <span class="ot">=</span> <span class="fu">ltexclusion</span>(usedata)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  B0.initial <span class="ot">=</span> B0Vlist.initial<span class="sc">$</span>B0</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)){</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Computing posterior parameters for each draw</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    Omega.inv      <span class="ot">=</span> <span class="fu">solve</span>(struct<span class="sc">$</span>kappap[i] <span class="sc">*</span> priors<span class="sc">$</span>Omega)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    Omega.post.inv <span class="ot">=</span> usedata<span class="sc">$</span>X<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> Omega.inv</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    Omega.post     <span class="ot">=</span> <span class="fu">solve</span>(Omega.post.inv)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    B.post         <span class="ot">=</span> (usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv) <span class="sc">%*%</span> Omega.post</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    S.post         <span class="ot">=</span> <span class="fu">solve</span>(usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> <span class="fu">solve</span>(struct<span class="sc">$</span>kappa0[i] <span class="sc">*</span> priors<span class="sc">$</span>S) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span><span class="fu">t</span>(priors<span class="sc">$</span>B) <span class="sc">-</span> B.post<span class="sc">%*%</span>Omega.post.inv<span class="sc">%*%</span><span class="fu">t</span>(B.post) )</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    nu.post        <span class="ot">=</span> <span class="fu">ncol</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> priors<span class="sc">$</span>nu</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    B0.initial <span class="ot">=</span> struct<span class="sc">$</span>B0.post[,,i<span class="dv">-1</span>]</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  B0.i <span class="ot">=</span> <span class="fu">rgn</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">S.inv =</span> <span class="fu">solve</span>(S.post), <span class="at">nu =</span> nu.post, <span class="at">V =</span> B0Vlist.initial<span class="sc">$</span>V, <span class="at">B0.initial =</span> B0.initial)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  B0.hat <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>((nu.post <span class="sc">-</span> usedata<span class="sc">$</span>N)<span class="sc">*</span>S.post))</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  B0.norm.i <span class="ot">=</span> <span class="fu">normalize.Gibbs.output.parallel</span>(B0.i, B0.hat)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  Bp.i <span class="ot">=</span> <span class="fu">rnorm.ngn</span>(B0.norm.i, B.post, Omega.post)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.post[,,i] <span class="ot">=</span> B0.norm.i</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>Bp.post[,,i] <span class="ot">=</span> Bp.i</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, update kappa</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  kappa0.nu.post <span class="ot">=</span> priors<span class="sc">$</span>kappa0.nu <span class="sc">+</span> (usedata<span class="sc">$</span>N<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  kappap.lambda.post <span class="ot">=</span> <span class="sc">-</span>(priors<span class="sc">$</span>kappap.nu <span class="sc">+</span> usedata<span class="sc">$</span>K <span class="sc">*</span> usedata<span class="sc">$</span>N)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  kappap.psi.post <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>priors<span class="sc">$</span>kappap.s</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  kappa0.s.post <span class="ot">=</span> priors<span class="sc">$</span>kappa0.s</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># kappap.chi.post = 0</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>N){</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># kappa0.s.post = kappa0.s.post + B0.norm.i[n,,1] %*% t( B0.norm.i[n,,1])</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    kappa0.s.post <span class="ot">=</span> kappa0.s.post <span class="sc">+</span> <span class="fu">sum</span>(B0.norm.i[n,,<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    kappap.chi.post <span class="ot">=</span> (Bp.i[n,,<span class="dv">1</span>] <span class="sc">-</span> B0.norm.i[n,,<span class="dv">1</span>] <span class="sc">%*%</span> B.post) <span class="sc">%*%</span> <span class="fu">t</span>(Bp.i[n,,<span class="dv">1</span>] <span class="sc">-</span> B0.norm.i[n,,<span class="dv">1</span>] <span class="sc">%*%</span> B.post)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">!=</span> (parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)){</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>kappa0[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> kappa0.s.post <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">df =</span> kappa0.nu.post)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>kappap[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> GIGrvg<span class="sc">::</span><span class="fu">rgig</span>(<span class="at">n=</span><span class="dv">1</span>, kappap.lambda.post, kappap.chi.post, kappap.psi.post)</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappa0 <span class="ot">=</span> struct<span class="sc">$</span>kappa0[(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappap <span class="ot">=</span> struct<span class="sc">$</span>kappap[(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.post <span class="ot">=</span> struct<span class="sc">$</span>B0.post[,,(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>Bp.post <span class="ot">=</span> struct<span class="sc">$</span>Bp.post[,,(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(struct)</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>structPosteriorMeans <span class="ot">=</span> <span class="cf">function</span>(struct){</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  struct.means <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa0 =</span> <span class="fu">mean</span>(struct<span class="sc">$</span>kappa0),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappap =</span> <span class="fu">mean</span>(struct<span class="sc">$</span>kappap),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">B0 =</span> <span class="fu">rowMeans</span>(struct<span class="sc">$</span>B0.post, <span class="at">dims =</span> <span class="dv">2</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bp =</span> <span class="fu">rowMeans</span>(struct<span class="sc">$</span>Bp.post, <span class="at">dims =</span> <span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code computes the prior, initialises matrices to store results, and samples the draws for the simulated data.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ext.sim.struct.means <span class="ot">=</span> <span class="fu">structPosteriorMeans</span>(ext.sim.struct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ext.sim.data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.sim.struct.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{cc}
1.0033946 &amp; 0.0000000\\
-0.0352557 &amp; 0.9969687\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ext.sim.data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.sim.struct.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccc}
0.0185505 &amp; 1.0000765 &amp; -0.0061724\\
-0.0117360 &amp; -0.0419334 &amp; 0.9844710\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ext.sim.data_kappa0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.sim.struct.means<span class="sc">$</span>kappa0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{c}
x\\
\hline
7.769759\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ext.sim.data_kappap <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.sim.struct.means<span class="sc">$</span>kappap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{c}
x\\
\hline
0.0001251\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<p>The following code computes the prior, initialises matrices to store results, and samples the draws for the actual data.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ext.struct.means <span class="ot">=</span> <span class="fu">structPosteriorMeans</span>(ext.struct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ext.data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.struct.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccc}
65.766785 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
-74.975438 &amp; 17.9395486 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
-11.142625 &amp; 3.8644179 &amp; 1.5076329 &amp; 0.000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
-16.705030 &amp; 0.7809112 &amp; -0.3835061 &amp; 19.401497 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
1.943894 &amp; -13.7631560 &amp; -0.4190424 &amp; -1.082113 &amp; 0.4591169 &amp; 0.0000000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
-13.017641 &amp; 7.0876776 &amp; -0.3743285 &amp; -5.576205 &amp; -0.0504306 &amp; 3.0195363 &amp; 0.000000 &amp; 0.000000 &amp; 0.000000\\
11.075814 &amp; 6.4582394 &amp; 0.3424943 &amp; -2.738378 &amp; -0.1750848 &amp; 0.4393645 &amp; 41.727393 &amp; 0.000000 &amp; 0.000000\\
-4.153708 &amp; -1.0353127 &amp; -0.3187322 &amp; -0.282347 &amp; 0.0323330 &amp; -0.1894225 &amp; 6.043551 &amp; 2.623814 &amp; 0.000000\\
-30.543898 &amp; 18.7154201 &amp; -0.1136240 &amp; -0.951428 &amp; -0.0365794 &amp; -0.9524253 &amp; 14.422079 &amp; -1.025192 &amp; 3.550537\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ext.data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.struct.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccccccccccccccccccccccccccccccc}
0.0010362 &amp; 65.769733 &amp; 0.0027176 &amp; 0.0173266 &amp; 0.0030893 &amp; 0.0007702 &amp; 0.0160497 &amp; 0.0022692 &amp; 0.0125158 &amp; 0.0133767 &amp; 0.0022461 &amp; 0.0024727 &amp; -0.0048175 &amp; 0.0032810 &amp; -0.0021053 &amp; 0.0106095 &amp; 0.0034114 &amp; 0.0050662 &amp; 0.0069058 &amp; 0.0020636 &amp; 0.0027441 &amp; -0.0028189 &amp; 0.0021419 &amp; 0.0069889 &amp; 0.0056734 &amp; 0.0040024 &amp; 0.0046971 &amp; 0.0009735 &amp; 0.0022410 &amp; 0.0023112 &amp; -0.0065299 &amp; 0.0017517 &amp; -0.0027556 &amp; 0.0001404 &amp; 0.0032982 &amp; 0.0028303 &amp; -0.0009766\\
-0.0009543 &amp; -74.978075 &amp; 17.9368141 &amp; -0.0166238 &amp; -0.0028516 &amp; -0.0038250 &amp; -0.0159975 &amp; -0.0025456 &amp; -0.0126902 &amp; -0.0141423 &amp; -0.0018443 &amp; -0.0025681 &amp; 0.0019309 &amp; -0.0031207 &amp; 0.0031670 &amp; -0.0119237 &amp; -0.0029377 &amp; -0.0071473 &amp; -0.0070198 &amp; -0.0018592 &amp; -0.0023410 &amp; 0.0058763 &amp; -0.0030906 &amp; -0.0042440 &amp; -0.0057776 &amp; -0.0029126 &amp; -0.0065502 &amp; -0.0006448 &amp; -0.0025902 &amp; -0.0027755 &amp; 0.0103281 &amp; -0.0022365 &amp; 0.0018017 &amp; 0.0007174 &amp; -0.0023879 &amp; -0.0038669 &amp; 0.0012630\\
0.0005203 &amp; -11.142245 &amp; 3.8654732 &amp; 1.4928481 &amp; 0.0008086 &amp; 0.0141064 &amp; 0.0003391 &amp; 0.0013693 &amp; 0.0007527 &amp; -0.0049832 &amp; -0.0001417 &amp; 0.0005122 &amp; -0.0127037 &amp; 0.0004333 &amp; -0.0013551 &amp; -0.0046428 &amp; 0.0002569 &amp; 0.0014391 &amp; -0.0063811 &amp; 0.0009795 &amp; 0.0001157 &amp; -0.0097077 &amp; 0.0003644 &amp; -0.0080566 &amp; -0.0060429 &amp; 0.0012478 &amp; -0.0020366 &amp; -0.0036283 &amp; 0.0003323 &amp; 0.0009972 &amp; -0.0068885 &amp; 0.0004648 &amp; -0.0039471 &amp; -0.0031393 &amp; 0.0008275 &amp; -0.0016875 &amp; -0.0001595\\
0.0003209 &amp; -16.701704 &amp; 0.7840614 &amp; -0.4040495 &amp; 19.4012416 &amp; -0.0122096 &amp; -0.0123049 &amp; 0.0044347 &amp; -0.0095287 &amp; -0.0158546 &amp; 0.0038931 &amp; 0.0030844 &amp; -0.0140497 &amp; -0.0025298 &amp; -0.0071916 &amp; -0.0117603 &amp; 0.0044882 &amp; -0.0061209 &amp; -0.0079715 &amp; 0.0049270 &amp; 0.0038168 &amp; -0.0002826 &amp; -0.0017330 &amp; 0.0016446 &amp; -0.0039984 &amp; 0.0040415 &amp; -0.0020382 &amp; 0.0023076 &amp; 0.0041805 &amp; 0.0039875 &amp; 0.0122399 &amp; -0.0010406 &amp; 0.0160895 &amp; 0.0063639 &amp; 0.0034201 &amp; 0.0032324 &amp; 0.0120354\\
0.0004075 &amp; 1.946896 &amp; -13.7607178 &amp; -0.4133453 &amp; -1.0803734 &amp; 0.5144205 &amp; -0.0078435 &amp; 0.0048790 &amp; -0.0014629 &amp; -0.0102667 &amp; 0.0023615 &amp; 0.0013595 &amp; -0.0017203 &amp; 0.0012995 &amp; -0.0109247 &amp; -0.0070431 &amp; 0.0042063 &amp; -0.0016936 &amp; -0.0074509 &amp; 0.0029831 &amp; 0.0013728 &amp; -0.0071399 &amp; 0.0004802 &amp; -0.0324948 &amp; -0.0040249 &amp; 0.0033205 &amp; -0.0013620 &amp; -0.0039713 &amp; 0.0014126 &amp; 0.0015925 &amp; -0.0018819 &amp; 0.0002526 &amp; -0.0070904 &amp; -0.0006064 &amp; 0.0037668 &amp; 0.0008697 &amp; -0.0014716\\
0.0005524 &amp; -13.014488 &amp; 7.0910298 &amp; -0.3788566 &amp; -5.5743527 &amp; -0.0360741 &amp; 3.0194561 &amp; 0.0018710 &amp; 0.0112891 &amp; -0.0024742 &amp; 0.0029790 &amp; 0.0028278 &amp; -0.0047533 &amp; 0.0018556 &amp; -0.0002145 &amp; -0.0039175 &amp; 0.0019185 &amp; 0.0088021 &amp; -0.0049643 &amp; 0.0025029 &amp; 0.0028135 &amp; -0.0046525 &amp; 0.0013722 &amp; -0.0100088 &amp; -0.0057103 &amp; 0.0015952 &amp; -0.0022714 &amp; -0.0022526 &amp; 0.0030801 &amp; 0.0026975 &amp; 0.0034906 &amp; 0.0022105 &amp; -0.0085793 &amp; -0.0021316 &amp; 0.0022442 &amp; -0.0060431 &amp; -0.0001639\\
0.0004754 &amp; 11.076626 &amp; 6.4598017 &amp; 0.3418874 &amp; -2.7384872 &amp; -0.1874785 &amp; 0.4385450 &amp; 41.7285141 &amp; 0.0108911 &amp; 0.0056823 &amp; 0.0013799 &amp; 0.0013117 &amp; 0.0017649 &amp; 0.0004434 &amp; 0.0066037 &amp; 0.0059019 &amp; 0.0015821 &amp; 0.0092802 &amp; 0.0025425 &amp; 0.0017885 &amp; 0.0012023 &amp; 0.0029985 &amp; 0.0006393 &amp; 0.0040936 &amp; 0.0023899 &amp; 0.0010272 &amp; 0.0110886 &amp; 0.0029971 &amp; 0.0015507 &amp; 0.0015320 &amp; 0.0011880 &amp; 0.0013957 &amp; 0.0089104 &amp; 0.0036127 &amp; 0.0011684 &amp; 0.0131515 &amp; -0.0019633\\
0.0010368 &amp; -4.150312 &amp; -1.0310496 &amp; -0.3212212 &amp; -0.2791283 &amp; 0.0226614 &amp; -0.1890716 &amp; 6.0468020 &amp; 2.6224047 &amp; -0.0047591 &amp; 0.0040371 &amp; 0.0043228 &amp; 0.0001767 &amp; 0.0034180 &amp; 0.0033794 &amp; -0.0041537 &amp; 0.0024314 &amp; -0.0075234 &amp; -0.0039264 &amp; 0.0036163 &amp; 0.0045220 &amp; 0.0037291 &amp; 0.0026739 &amp; 0.0037257 &amp; -0.0031199 &amp; 0.0036405 &amp; -0.0130276 &amp; -0.0030097 &amp; 0.0035933 &amp; 0.0044305 &amp; 0.0007499 &amp; 0.0034120 &amp; 0.0024961 &amp; -0.0023203 &amp; 0.0033733 &amp; -0.0221044 &amp; -0.0039983\\
-0.0002361 &amp; -30.543563 &amp; 18.7155969 &amp; -0.1110339 &amp; -0.9502979 &amp; -0.0176969 &amp; -0.9390843 &amp; 14.4223885 &amp; -1.0141920 &amp; 3.5484042 &amp; 0.0005605 &amp; 0.0007478 &amp; -0.0067633 &amp; 0.0002541 &amp; 0.0108423 &amp; -0.0031437 &amp; 0.0000275 &amp; 0.0097553 &amp; -0.0069550 &amp; 0.0008352 &amp; 0.0010575 &amp; -0.0072324 &amp; -0.0002358 &amp; -0.0102601 &amp; -0.0061879 &amp; 0.0005823 &amp; 0.0140258 &amp; -0.0088380 &amp; 0.0001186 &amp; 0.0010177 &amp; -0.0059889 &amp; 0.0000605 &amp; -0.0212925 &amp; -0.0092250 &amp; 0.0009169 &amp; 0.0049728 &amp; -0.0069410\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ext.data_kappa0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.struct.means<span class="sc">$</span>kappa0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{c}
x\\
\hline
5508.177\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ext.data_kappap <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.struct.means<span class="sc">$</span>kappap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{c}
x\\
\hline
7.38e-05\\
\end{array}
\right)\, .
\end{equation*}\]</span></p>
</section>
</section>
<section id="empirical-investigation" class="level1">
<h1>Empirical Investigation</h1>
<section id="impulse-response-functions-irfs" class="level2">
<h2 class="anchored" data-anchor-id="impulse-response-functions-irfs">Impulse Response Functions (IRFs)</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cashrate.irf-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the AU Cash Rate Shock</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/usffr.irf-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the US Federal Funds Rate Shock</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="forecast-error-variance-decomposition" class="level2">
<h2 class="anchored" data-anchor-id="forecast-error-variance-decomposition">Forecast Error Variance Decomposition</h2>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
</section>
<section id="references" class="level1 unnumbered">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-AK_2017" class="csl-entry" role="doc-biblioentry">
Aliber, Robert Z., and Charles P. Kindleberger. 2017. <em>Manias, Panics, and Crashes: A History of Financial Crises, Seventh Edition</em>. Springer.
</div>
<div id="ref-arias2018a" class="csl-entry" role="doc-biblioentry">
Arias, Jonas E., Juan F. Rubio‐Ramírez, and Daniel Waggoner. 2018. <span>“Inference Based on Structural Vector Autoregressions Identified with Sign and Zero Restrictions: Theory and Applications.”</span> <em>Econometrica</em> 86 (2): 685–720. <a href="https://EconPapers.repec.org/RePEc:wly:emetrp:v:86:y:2018:i:2:p:685-720">https://EconPapers.repec.org/RePEc:wly:emetrp:v:86:y:2018:i:2:p:685-720</a>.
</div>
<div id="ref-rr2010" class="csl-entry" role="doc-biblioentry">
Rubio-Ramirez, Juan F, Daniel Waggoner, and Tao Zha. 2010. <span>“Structural Vector Autoregressions: Theory of Identification and Algorithms for Inference.”</span> <em>Review of Economic Studies</em> 77 (2): 665–96. <a href="https://EconPapers.repec.org/RePEc:oup:restud:v:77:y:2010:i:2:p:665-696">https://EconPapers.repec.org/RePEc:oup:restud:v:77:y:2010:i:2:p:665-696</a>.
</div>
<div id="ref-Sweeney_2023" class="csl-entry" role="doc-biblioentry">
Sweeney, Nila. 2023. <em>Australian Financial Review</em>, January. <a href="https://www.afr.com/property/residential/australia-s-9-3-trillion-housing-question-20230111-p5cbsu">https://www.afr.com/property/residential/australia-s-9-3-trillion-housing-question-20230111-p5cbsu</a>.
</div>
<div id="ref-waggoner2003a" class="csl-entry" role="doc-biblioentry">
Waggoner, Daniel F., and Tao Zha. 2003. <span>“A Gibbs Sampler for Structural Vector Autoregressions.”</span> <em>Journal of Economic Dynamics and Control</em> 28 (2): 349–66. https://doi.org/<a href="https://doi.org/10.1016/S0165-1889(02)00168-9">https://doi.org/10.1016/S0165-1889(02)00168-9</a>.
</div>
<div id="ref-waggoner2003b" class="csl-entry" role="doc-biblioentry">
Waggoner, Daniel, and Tao Zha. 2003. <span>“Likelihood Preserving Normalization in Multiple Equation Models.”</span> <em>Journal of Econometrics</em> 114 (2): 329–47. <a href="https://EconPapers.repec.org/RePEc:eee:econom:v:114:y:2003:i:2:p:329-347">https://EconPapers.repec.org/RePEc:eee:econom:v:114:y:2003:i:2:p:329-347</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>